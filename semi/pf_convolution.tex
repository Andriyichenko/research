\documentclass[dvipdfmx,a4paper,12pt]{jarticle}
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage[dvipdfmx]{graphicx}
\usepackage{tikz}
\usetikzlibrary{positioning, intersections, calc, arrows.meta, math, through, shadows}
\usepackage{tcolorbox}
\tcbuselibrary{theorems,breakable}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage{otf}
\usepackage{xspace}
\usepackage{newpxtext}
\usepackage[utf8]{inputenc} %中国語コンパイル環境-cjkホットショット
\usepackage{CJKutf8,CJKspace,CJKpunct} %中国語コンパイル環境
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage{okumacro} %漢字ruby
\renewcommand{\abstractname}{注意事項}
\newtagform{textbf}[	extbf]{[}{]}
\usetagform{textbf}
\newcommand*{\ie}{\textbf{\textit{i.e.}}\@\xspace}
\renewcommand{\qedsymbol}{$\blacksquare$}
\newtcbtheorem[]{reidai}{例題}
{fonttitle=\gtfamily\sffamily\bfseries\upshape\large,
colframe=black,colback=black!15!white,
rightrule=1pt,leftrule=1pt,bottomrule=2pt,
colbacktitle=black,theorem style=standard,breakable,arc=10pt}
{tha}
\renewcommand{\thefootnote}{\arabic{footnote}}
\newtheoremstyle{mystyle}%
  {}%                      % 上部スペース
  {}%                      % 下部スペース
  {}%                      % 本文フォント
  {}%                      % 1行目のインデント量
  {\bfseries}%             % 見出しフォント
  :%                       % 見出し後の句読点
  { }%                     % 見出し後のスペース
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}
\theoremstyle{mystyle}
% \setcounter{section}{0}
% \stepcounter{section}
% セクションカウンターを使用するが、表示はしない新しいセクションコマンドを作成
\newtheorem{dfn}{\texttt{Def.}}[section]
\newtheorem{exm}[dfn]{\texttt{Ex.}}
\newtheorem{prop}[dfn]{\texttt{Prop.}}
\newtheorem{lem}[dfn]{\texttt{Lem.}}
\newtheorem{thm}[dfn]{\texttt{Thm.}}
\newtheorem{cor}[dfn]{\texttt{Cor.}}
\newtheorem{rem}[dfn]{\texttt{Rem.}}
\newtheorem{fact}[dfn]{\texttt{Fact}}
\renewcommand{\qedsymbol}{$\blacksquare$}
\usepackage{lipsum} % 用于生成示例文本
\usepackage{float} % 强制浮动
\usepackage{tikz} % 用于定位
%排版
\newcommand{\kai}%解答
{\noindent
\begin{tikzpicture}[scale=0.2, baseline=2.8pt]
\draw (3.3,1.2) node{\large\textgt{解 答}};
\draw[thick, rounded corners=3pt,] (0,0)--(6.5,0)--(6.5,2.4)--(0,2.4)--cycle;
\end{tikzpicture}}
\newcommand{\shomei}%証明
{\noindent
\begin{tikzpicture}[scale=0.2, baseline=2.8pt]
\draw (3.3,1.2) node{\textgt{証 明}};
\draw[double,thick,rounded corners=3pt,] (0,0)--(6.5,0)--(6.5,2.4)--(0,2.4)--cycle;
\end{tikzpicture};}
%補足
\newcommand{\hosoku}{\noindent
\begin{tikzpicture}[scale=0.2, baseline=2.8pt]
\draw (6,1) node{\large\textgt{補足}};
\fill (0,1)--(1,0)--(2,1)--(1,2)--cycle;
\fill[gray] (1,1)--(2,0)--(3,1)--(2,2)--cycle;
\fill (2,1)--(3,0)--(4,1)--(3,2)--cycle;
\fill (10,1)--(11,0)--(12,1)--(11,2)--cycle;
\fill[gray] (9,1)--(10,0)--(11,1)--(10,2)--cycle;
\fill (8,1)--(9,0)--(10,1)--(9,2)--cycle;
\end{tikzpicture};}
%注意
\newcommand{\chui}{\noindent
\begin{tikzpicture}[scale=0.2, baseline=2.8pt]
\fill (0,0)--(6.5,0)--(6.5,2.2)--(0,2.2);
\draw (3.3,1) node[white]{\large\textgt{注意！}};
\draw[thick] (0,0)--(6.5,0)--(6.5,2.2)--(0,2.2)--cycle;
\end{tikzpicture};}
\title{\vspace{-3cm}\textbf{\Large 独立な２つ確率変数の和の確率密度関数は\\ 畳み込みである証明}}  %タイトル
\author{\texttt{YI Ran} - $\mathnormal{21122200512}$\\ \texttt{andreyi@outlook.jp}}  %著者名
\date{}  %日付
\begin{document}
\maketitle
%\vspace{-0.4cm}
%\begin{figure}[H]
%\centering
%\begin{tikzpicture}[remember picture, overlay]
%   \node[anchor=north east] at (current page.north east) {%
%        \includegraphics[width=2cm]{pics/qr.png} % 修正图片地址
%    };
%    \node[anchor=north east, yshift=-2cm] at (current page.north east) {デジタル版はここ};
%\end{tikzpicture}
%\label{fig:my_label}
%\end{figure}
%\begin{abstract} %概要
  %注意事項
%\end{abstract}
%\begin{reidai}{2次方程式}{解答}
%\end{reidai}
%\begin{proof}
%\end{proof}
\section*{\textbf{問題}}

\noindent
$W_\sigma(x, x_k) = \frac{1}{\sqrt{2\pi\sigma}} e^{-\frac{1}{2\sigma^2}|x-x_k|^2}\sim \mathcal{N}(x_k,\sigma^2),\ W_\sigma(x, x_j) = \frac{1}{\sqrt{2\pi\sigma}} e^{-\frac{1}{2\sigma^2}|x-x_j|^2}\sim \mathcal{N}(x_k,\sigma^2)$とし、
windowがガウシアンの場合、$W_\sigma(x, x') = \phi_\sigma(x - x')$ であり、$\phi_\sigma(t) = \frac{1}{\sqrt{2\pi\sigma}} e^{-\frac{t^2}{2\sigma^2}}$ である。
$ \displaystyle\int \phi_{\sigma}(x-x_k)\phi_{\sigma}(x-x_j)dx \displaystyle\overset{t=x-x_k}{=}\int \phi_{\sigma}(t)\phi_{\sigma}(t-(x_j-x_k))dt=\displaystyle (\phi_{\sigma}\ast\phi_{\sigma})(x_j-x_k)$はなぜ$x_j-x_k$の確率密度関数になるのか？

\section*{\textbf{解答}}


\begin{proof}

$W=x_j-x_k$,\ $X=x-x_k$,\ $Y=x_j-x$,\ $W$の密度関数を$f_{W}(w)$とすると、$W=((x-x_k)+(x_j-x))=X+Y$となる。したがって、
$$
F_{W}(w)=P(W\leq w)=\displaystyle\int_{-\infty}^{w}f_{W}(w)dw\ \implies\ f_{W}(w)=\frac{d}{dw}F_{W}(w)
$$ 

\noindent
$f_{W}(w)$は微積分学の基本原理を用いて$F_{W}(w)$を微分する式である。\\

\noindent
次に、$F_{W}(w)$は同時確率密度関数,$X$と$Y$は独立な確率変数であるため、$F_{W}(w)=P(X+Y\leq w)=\displaystyle \iint_{\{x+y\leq w\}} f_{XY}(x,y)dxdy\overset{indep.}{=}\iint_{\{x+y\leq w\}} f_{X}(x)f_{Y}(y)dxdy$となる。
$w\in \mathbb{R}$であるので、一番外のyの積分の範囲は$-\infty$から$\infty$までであり、内の$x$の積分の範囲は$x\leq w-y$により、$-\infty$から$w-y$までである。\\

\noindent
したがって、以下のように書き換えることができる：
$$
  F_{W}(w)=\int_{-\infty}^{\infty} f_{Y}(y)\left(\int_{-\infty}^{w-y} f_{X}(x)dx\right)dy
$$
ここで、$x=w-y$とおくと、$-\infty< w-y\leq w-y\ \implies\ -\infty < w\leq w$となる。一方で、$\dfrac{dx}{dw}=1$である。以下のように書ける：
$$
\int_{-\infty}^{\infty} f_{Y}(y)\left(\int_{-\infty}^{w-y} f_{X}(x)dx\right)dy=\int_{-\infty}^{\infty} f_{Y}(y)\left(\int_{-\infty}^{w} f_{X}(w-y)dw\right)dy
$$
\noindent
したがって、
\begin{align*}
  f_{W}(w)=\dfrac{d}{dw}F_{W}(w)&=\int_{-\infty}^{\infty} f_{Y}(y)\ \dfrac{d}{dw}\left(\int_{-\infty}^{w} f_{X}(w-y)dw\right)dy  \\
  &=\int_{-\infty}^{\infty} f_{Y}(y)f_{X}(w-y)dy \\
  &=\int_{-\infty}^{\infty} \phi_{\sigma}(x_j-x)\phi_{\sigma}(x-x_k)dx \\
  &=\int_{-\infty}^{\infty} \phi_{\sigma}(x-x_k)\phi_{\sigma}(x-x_j)dx \quad \Leftarrow({\footnotesize \text{\color{red} 正規分布の密度関数は偶関数なので}})\\
  &=(\phi_{\sigma}\ast\phi_{\sigma})(x_j-x_k)=f_{x+y}(w)
\end{align*}
ここで、$t=x-x_k$とおくと、$\dfrac{dt}{dx}=1$であるため、$f_{W}(t)=\displaystyle\int_{-\infty}^{\infty} \phi_{\sigma}(t)\phi_{\sigma}(t-(x_j-x_k))dt = (\phi_{\sigma}\ast\phi_{\sigma})(x_j-x_k)$となる。\ie $(\phi_{\sigma}\ast\phi_{\sigma})(x_j-x_k)\sim \mathcal{N}(x_j-x_k,2\sigma^2)$\\

\noindent
したがって、$(\phi_{\sigma}\ast\phi_{\sigma})(x_j-x_k)=\phi_{\sigma\sqrt{2}}(x_j-x_k)=W_{\sigma\sqrt{2}}(x_j, x_k)$ 

\end{proof}
\end{document} 